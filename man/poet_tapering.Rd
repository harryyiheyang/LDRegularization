% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/poet_tapering.R
\name{poet_tapering}
\alias{poet_tapering}
\title{poet_tapering: POET with tapering on the idiosyncratic covariance}
\usage{
poet_tapering(
  S,
  n,
  cutoff_method = "D.ratio",
  k_min = 5,
  k_max = min(15, round(nrow(S)/2)),
  tapering_vec = seq(2, 20, 2),
  eigenmin = 0.001
)
}
\arguments{
\item{S}{A symmetric matrix (p×p). It can be a covariance matrix or a
correlation matrix.}

\item{n}{The sample size that produced `S`.}

\item{cutoff_method}{Character string specifying how to choose the number of
factors `m`. One of `"D.ratio"` or `"ratio"` (default: `"D.ratio"`).}

\item{k_min, k_max}{Integers giving the search range for the number of
factors `m`. Defaults are `k_min = 5` and
`k_max = min(15, floor(nrow(S) / 2))`.}

\item{tapering_vec}{Integer vector of candidate bandwidths for tapering.
For each bandwidth `b`, the idiosyncratic matrix `Σ_u` is multiplied
elementwise by a tapering kernel `wij(b)` that decreases with
band distance `|i - j|` (e.g., Bartlett/linear taper:
`wij = max(1 - |i-j|/b, 0)`). Default: `seq(2, 20, 2)`.
Use `0` to keep only the diagonal (degenerates to diagonal idiosyncratic part).}

\item{eigenmin}{The threshold for the minimum eigenvalues used in determining the optimal shrinkage parameter. Default is `1e-3`.}
}
\value{
A covariance matrix (p×p) regularized by POET + tapering; symmetric
  and positive semi-definite up to `eigenmin`.
}
\description{
Apply the POET framework where the factor component is estimated from the
leading eigenpairs and the idiosyncratic component is tapered (entrywise
multiplied by a tapering kernel with bandwidth chosen from `tapering_vec`).
Note: tapering assumes variables are ordered on a meaningful 1D index
(e.g., time or spatial lattice); otherwise band distance |i - j| has no meaning.
}
