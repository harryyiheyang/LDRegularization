% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/poet_thresholding.R
\name{poet_thresholding}
\alias{poet_thresholding}
\title{poet_thresholding: POET with entrywise thresholding on the idiosyncratic covariance}
\usage{
poet_thresholding(
  S,
  n,
  cutoff_method = "D.ratio",
  k_min = 5,
  k_max = min(15, round(nrow(S)/2)),
  thresholding_vec = seq(0.01, 0.2, by = 0.02),
  eigenmin = 0.001
)
}
\arguments{
\item{S}{A symmetric matrix (p×p). It can be a covariance matrix or a
correlation matrix.}

\item{n}{The sample size that produced `S`.}

\item{cutoff_method}{Character string specifying how to choose the number of
factors `m`. One of `"D.ratio"` or `"ratio"` (default: `"D.ratio"`).}

\item{k_min, k_max}{Integers giving the search range for the number of
factors `m`. Defaults are `k_min = 5` and
`k_max = min(15, floor(nrow(S) / 2))`.}

\item{thresholding_vec}{Numeric vector of candidate thresholding levels for
the off-diagonal entries of the idiosyncratic covariance.
Default: `seq(0.01, 0.20, by = 0.02)`.}

\item{eigenmin}{The threshold for the minimum eigenvalues used in determining the optimal shrinkage parameter. Default is `1e-3`.}
}
\value{
A covariance matrix (p×p) regularized by POET + entrywise
  thresholding; symmetric and positive semi-definite up to `eigenmin`.
}
\description{
Apply the POET framework where the factor component is estimated from the
leading eigenpairs and the idiosyncratic component is regularized by
entrywise thresholding. Off-diagonal elements are thresholded with a
candidate parameter chosen from `thresholding_vec`; the diagonal is kept.
The number of latent factors is selected by a ratio-type rule.
}
